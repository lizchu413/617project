import matplotlib.pyplot as plt

if __name__ == "__main__": 
    model = input("model make graph: ")
    if model == "t5": 
        lr5e4_trloss = [4.0495, 2.9127, 2.0538, 1.3592, 0.8469, 0.5132, 0.281, 0.1478]
        lr5e4_ttloss = [4.895603179931641, 5.04517936706543, 
                        4.804222106933594, 4.851597309112549,
                        5.142146110534668, 5.290489673614502, 
                        5.559502124786377, 5.66932487487793]
        lr5e4_ttf1 = [0.0847865358071929, 0.0785056466907905, 
                    0.08601888002082546, 0.08804455507660126, 
                    0.08448215347798302, 0.08469844687772982, 
                    0.0855547358787962, 0.08483484745225604]
        
        lr5e5_trloss = [0.9993, 0.6589, 0.4235, 0.5815, 0.483, 0.4151, 0.3677, 0.3389]
        lr5e5_ttloss = [4.875940322875977, 4.98838472366333, 
                        5.120060443878174, 5.145352840423584, 
                        5.2013654708862305, 5.312007904052734, 
                        5.350470066070557, 5.377941131591797]
        lr5e5_ttf1 = [0.0866830905672496, 0.08630209115758064, 
                    0.08919905487428206, 0.08654283835608599,
                    0.08600878855255654, 0.08882893956787345, 
                    0.08690557323453339, 0.08674555219363463]
        
        lr5e6_trloss = [0.5556, 0.6377, 0.5167, 0.8031, 0.7869, 0.7766, 0.7702, 0.7671]
        lr5e6_ttloss = [5.009696960449219, 4.985236644744873, 
                        5.019103527069092, 4.95963716506958, 
                        4.965780258178711, 4.964273452758789, 
                        4.966511249542236, 4.968853950500488]
        lr5e6_ttf1 = [0.08666055807455031, 0.08592949016897979, 
                    0.0864979750407509, 0.08684600650266085, 
                    0.08655510580033253, 0.08696740500748494, 
                    0.08708861777404651, 0.08708861777404651]

        wd0001_trloss = [2.8588, 2.1589, 1.746, 1.4598, 1.2428, 1.0761, 0.9646, 0.8964]
        wd0001_ttloss = [3.1932239532470703, 3.240645170211792, 
                        3.352607488632202, 3.406649589538574, 
                        3.5533106327056885, 3.656705856323242, 
                        3.7389252185821533, 3.794752836227417]
        wd0001_ttf1 = [0.11935568335204523, 0.11809132634247378, 
                    0.11570424892282644, 0.11275522052562784,
                    0.11344111887656809, 0.11345515205200901, 
                    0.11212000479115636, 0.11006751241541325]
        
        wd00001_trloss = [1.8062, 1.7761, 1.4314, 1.1943, 1.0114, 0.8699, 0.7734, 0.713]
        wd00001_ttloss = [3.2870471477508545, 3.362387180328369,
                        3.495137929916382, 3.5516786575317383, 
                        3.7053022384643555, 3.823561906814575, 
                        3.9056332111358643, 3.958203077316284]
        wd00001_ttf1 = [0.11897095780074705, 0.11882030538416438, 
                        0.11369587259834836, 0.11328045565938143, 
                        0.11478324847281816, 0.11266628451958174, 
                        0.11099489894359797, 0.11018769218854865]
    else: 
        lr5e4_trloss = [6.9486, 6.4803, 6.4308, 6.4185, 6.4066, 6.3934, 6.3811, 6.3725]
        lr5e4_ttloss = [7.336252212524414, 7.389716625213623, 
                        7.428992748260498, 7.468847751617432, 
                        7.519082069396973, 7.580188751220703, 
                        7.554827690124512, 7.55235481262207]
        lr5e4_ttf1 = [0.008319327731092436, 0.0, 
                      0.008319327731092436, 0.008319327731092436, 
                      0.008319327731092436, 0.008319327731092436, 
                      0.008319327731092436, 0.008319327731092436]
        
        lr5e5_trloss = [7.0316, 5.9537, 5.573, 5.326, 5.1277, 4.9495, 4.8374, 4.7551]
        lr5e5_ttloss = [6.984921932220459, 6.90219259262085, 
                        6.934295654296875, 6.970125675201416, 
                        7.087448596954346, 7.112332344055176, 
                        7.156655311584473, 7.199698448181152]
        lr5e5_ttf1 = [0.02217562930819781, 0.024965931631513113, 
                      0.02585398830143129, 0.028266414746556005,
                      0.025875617359957043, 0.027279238811416785, 
                      0.026503462733879476, 0.027259012585810906]
        
        lr5e6_trloss = [6.4285, 6.4338, 6.4172, 6.4199, 6.4191, 6.4161, 6.4153, 6.4191]
        lr5e6_ttloss = [7.311844348907471, 7.321897506713867, 
                        7.3313307762146, 7.33566951751709, 
                        7.342538833618164, 7.344436168670654, 
                        7.34583854675293, 7.346199989318848]
        lr5e6_ttf1 = [0.008319327731092436, 0.008319327731092436, 
                      0.008319327731092436, 0.008319327731092436, 
                      0.008319327731092436, 0.008319327731092436, 
                      0.008319327731092436, 0.008319327731092436]
        
        wd0001_trloss = [7.8342, 6.5479, 6.1272, 5.8657, 5.6945, 5.5591, 5.4643, 5.4209]
        wd0001_ttloss = [7.1323347091674805, 6.948794364929199, 
                         6.866392135620117, 6.87392520904541, 
                         6.886005878448486, 6.918461799621582, 
                         6.899392604827881, 6.915067195892334]
        wd0001_ttf1 = [0.01952526138650729, 0.02220396199116346, 
                       0.021336955470900403, 0.024257453929249974, 
                       0.025020297198869265, 0.025643884690045953, 
                       0.025287563586484003, 0.025897172183964062]
        
        wd00001_trloss = [5.8863, 5.5585, 5.362, 5.2763, 5.1666, 5.0597, 4.9737, 4.9373]
        wd00001_ttloss = [6.859320163726807, 6.904036045074463, 
                          6.884002685546875, 7.004992485046387, 
                          6.999072074890137, 7.062593460083008,
                          7.066424369812012, 7.0824408531188965]
        wd00001_ttf1 = [0.025729496355838877, 0.02790959876704875, 
                        0.022231427320235083, 0.028512623888252944, 
                        0.027132420431395785, 0.029639157247132487, 
                        0.02724108821237165, 0.028161012160138662]
        
    base_trloss = [1.3419, 0.7438, 0.7051, 0.6715, 0.6420, 0.6156, 0.5913, 0.5686]
    base_ttloss = [0.8988, 0.9269, 0.9582, 1.0225, 0.9783, 0.8992, 0.9397, 1.1338]
    base_ttf1 = [0.8743, 0.8762, 0.8794, 0.8799, 0.8809, 0.8813, 0.8828, 0.8832]

    plt.figure()
    plt.plot(base_trloss, label="train loss: baseline")
    plt.plot(base_ttloss, label="test loss: baseline")
    plt.plot(lr5e4_trloss, label="train loss: lr = 5e-4")
    plt.plot(lr5e4_ttloss, label="test loss: lr = 5e-4")
    plt.plot(lr5e5_trloss, label="train loss: lr = 5e-5")
    plt.plot(lr5e5_ttloss, label="test loss: lr = 5e-5")
    plt.plot(lr5e6_trloss, label="train loss: lr = 5e-6")
    plt.plot(lr5e6_ttloss, label="test loss: lr = 5e-6")
    plt.legend()
    plt.title(f"Code{model.upper()} Training & Testing Loss (Learning Rate)")
    plt.savefig(f"{model}_lr_exp_loss.png")

    plt.figure()
    plt.plot(base_trloss, label="train loss: baseline")
    plt.plot(base_ttloss, label="test loss: baseline")
    plt.plot(lr5e5_trloss, label="train loss: wd = 0")
    plt.plot(lr5e5_ttloss, label="test loss: wd = 0")
    plt.plot(wd0001_trloss, label="train loss: wd = 0.001")
    plt.plot(wd0001_ttloss, label="test loss: wd = 0.001")
    plt.plot(wd00001_trloss, label="train loss: wd = 0.0001")
    plt.plot(wd00001_ttloss, label="test loss: wd = 0.0001")
    plt.legend()
    plt.title(f"Code{model.upper()} Training & Testing Loss (Weight Decay)")
    plt.savefig(f"{model}_wd_exp_loss.png")

    plt.figure()
    plt.plot(lr5e4_ttf1, label="f1 score: lr = 5e-4")
    plt.plot(lr5e5_ttf1, label="f1 score: lr = 5e-5, wd = 0 (default)")
    plt.plot(lr5e6_ttf1, label="f1 score: lr = 5e-6")
    plt.plot(wd0001_ttf1, label="f1 score: wd = 0.001")
    plt.plot(wd00001_ttf1, label="f1 score: wd = 0.0001")
    plt.legend()
    plt.title(f"Code{model.upper()} Test F-1 Score (Learning Rate & Weight Decay)")
    plt.savefig(f"{model}_both_exp_f1.png")